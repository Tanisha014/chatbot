<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Support Chatbot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chat-container {
            height: 500px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        .bot-message {
            background-color: #f3f4f6;
            border-radius: 18px 18px 18px 0;
        }
        .user-message {
            background-color: #3b82f6;
            color: white;
            border-radius: 18px 18px 0 18px;
        }
        .option-button {
            transition: all 0.2s ease;
        }
        .option-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .typing-indicator span {
            animation: bounce 1.5s infinite ease-in-out;
        }
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="max-w-md mx-auto my-10 bg-white rounded-xl shadow-md overflow-hidden">
        <div class="bg-blue-600 p-4 text-white">
            <div class="flex items-center">
                <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center mr-3">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/a6e13cf4-b518-4ac1-b8dd-e57a3845c7d4.png" alt="Chatbot avatar with friendly face and blue color scheme" />
                </div>
                <div>
                    <h1 class="font-bold text-lg">E-Commerce Assistant</h1>
                    <p class="text-xs opacity-80">Always here to help</p>
                </div>
            </div>
        </div>

        <div class="chat-container p-4 space-y-3" id="chatContainer">
            <!-- Chat messages will appear here -->
        </div>

        <div class="p-4 bg-gray-50 border-t">
            <div id="optionsContainer" class="mb-3 space-y-2">
                <!-- Option buttons will appear here -->
            </div>
            <div class="flex">
                <input type="text" id="userInput" placeholder="Type your message..." class="flex-grow px-4 py-2 rounded-l-full border focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button id="sendButton" class="bg-blue-600 text-white px-4 py-2 rounded-r-full hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Send
                </button>
            </div>
        </div>
    </div>

    <script>
        // Chatbot knowledge base - rules and responses
        const chatbotKnowledge = {
            greeting: {
                message: "Hello! I'm your e-commerce assistant. How can I help you today?",
                options: [
                    { text: "Order Status and Invoice", next: "orderStatus" },
                    { text: "Returns & Refunds", next: "returns" },
                    { text: "Product Questions", next: "productQuestions" },
                    { text: "Custom order format", next: "custom" }
                ]
            },
            orderStatus: {
                message: "Please enter your order number so I can help with your order.",
                inputExpected: true,
                options: [
                    { text: "I don't have my order number", next: "noOrderNumber" },
                    { text: "Back to main menu", next: "greeting" }
                ]
            },
            noOrderNumber: {
                message: "No problem! I can look up your order by email. What's the email address associated with your account?",
                options: [
                    { text: "Back to main menu", next: "greeting" }
                ],
                inputExpected: true
            },
            returns: {
                message: "I can help with returns and refunds. What would you like to do?",
                options: [
                    { text: "Issue with product", next: "issue" },
                    { text: "Check refund status", next: "refundStatus" },
                    { text: "Return policy", next: "returnPolicy" },
                    { text: "Back to main menu", next: "greeting" }
                ]
            },
            issue: {
                message: "Why do you wish to return the product?",
                options: [
                    { text: "Size too big", next: "returnPolicy" },
                    { text: "Size too small", next: "returnPolicy" },
                    { text: "Wrong product", next: "returnPolicy" },
                    { text: "Quality issue", next: "quality" },
                    { text: "Back to returns", next: "returns" }
                ],
                inputExpected: true
            },
            quality: {
                message: "What issue you face?",
                options: [
                    { text: "print not good", next: "returnPolicy" },
                    { text: "material issue", next: "returnPolicy" },
                    { text: "Back to returns", next: "returns" }
                ],
                inputExpected: true
            },
            refundStatus: {
                message: "To check your refund status, please provide your return tracking number or order number.",
                options: [
                    { text: "Back to returns", next: "returns" }
                ],
                inputExpected: true
            },
            returnPolicy: {
                message: "Our return policy: You can return most items within 30 days of delivery for a full refund. Some items like electronics must be returned within 14 days. All items must be in original condition with tags attached.",
                options: [
                    { text: "Start a return", next: "startReturn" },
                    { text: "Back to returns", next: "returns" }
                ]
            },
            productQuestions: {
                message: "What product are you interested in? You can ask about availability, features, or compatibility.",
                options: [
                    { text: "Check availability", next: "checkAvailability" },
                    { text: "Product features", next: "productFeatures" },
                    { text: "Compatibility questions", next: "compatibility" },
                    { text: "Back to main menu", next: "greeting" }
                ],
                inputExpected: true
            },
            checkAvailability: {
                message: "To check product availability, please provide the product name or SKU number.",
                options: [
                    { text: "Back to product questions", next: "productQuestions" }
                ],
                inputExpected: true
            },
            productFeatures: {
                message: "Which product's features would you like to know about? Please provide the product name.",
                options: [
                    { text: "Back to product questions", next: "productQuestions" }
                ],
                inputExpected: true
            },
            compatibility: {
                message: "For compatibility questions, please specify the products you're checking compatibility between.",
                options: [
                    { text: "Back to product questions", next: "productQuestions" }
                ],
                inputExpected: true
            },
           
            
            updateAddress: {
                message: "Please provide your new shipping address.",
                options: [
                    { text: "Back to account updates", next: "updateAccount" }
                ],
                inputExpected: true
            },
            paymentMethods: {
                message: "Would you like to add, update, or remove a payment method?",
                options: [
                    { text: "Add payment method", next: "addPayment" },
                    { text: "Update payment method", next: "updatePayment" },
                    { text: "Back to account help", next: "accountHelp" }
                ]
            },
            fallback: {
                message: "I couldn't find a solution to your problem. Please contact our customer support team at 1-800-555-0199 for further assistance.",
                options: [
                    { text: "Back to main menu", next: "greeting" }
                ]
            },
            custom: {
                message: "Contact us on mail",// mail to be written 
               // message: "insert image",// image insertion url
               // message: "select the design",
                message: "select the size",
               // message: "Confirm the demo",
                options: [
                    { text: "xs", next: "design"},
                    { text: "s", next: "design"},
                    { text: "m", next: "design"},
                    { text: "l", next: "design"}
                ],
                inputExpected: true
            },
            design: {
                message: "select the design",
                options:[
                    {text: "design 1", next: "image"},
                    {text: "design 2", next: "image"},
                    {text: "design 3", next: "image"}
                ],
                inputExpected: true
            },
            image: {
                message: "insert the image",
                options:[
                    {text: "image", next: "demo"}//instead of text find the word and rewrite it
                ],
                inputExpected: true
            },
            demo: {
                message: "choose the demo",
                options: [
                    { text: "Back to main menu", next: "greeting" }
                ]
                //options:[
                    //{text: "image", next: "demo"}//instead of text find the word and rewrite it
                //],
                //inputExpected: true
            },
            invoice: {
                message: "To get a invoice, Please provide me with your order number.",
                options: [
                    {text: "Back to main menu", next: "greeting"}
                ],
                inputExpected: true 
            }
        };

        // DOM elements
        const chatContainer = document.getElementById('chatContainer');
        const optionsContainer = document.getElementById('optionsContainer');
        const userInput = document.getElementById('userInput');
        const sendButton = document.getElementById('sendButton');

        // Current state
        let currentState = 'greeting';
        let userOrderNumber = '';
        let conversationHistory = [];

        // Initialize chatbot
        function initChatbot() {
            displayBotMessage(chatbotKnowledge.greeting.message);
            displayOptions(chatbotKnowledge.greeting.options);
        }

        // Display bot message
        function displayBotMessage(message) {
            // Show typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'flex space-x-1 p-3 bot-message w-max max-w-xs typing-indicator';
            typingIndicator.innerHTML = '<span>.</span><span>.</span><span>.</span>';
            chatContainer.appendChild(typingIndicator);
            
            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // After delay, replace with actual message
            setTimeout(() => {
                chatContainer.removeChild(typingIndicator);
                
                const messageElement = document.createElement('div');
                messageElement.className = 'p-3 bot-message w-max max-w-xs';
                messageElement.textContent = message;
                chatContainer.appendChild(messageElement);
                
                // Add to conversation history
                conversationHistory.push({
                    sender: 'bot',
                    message: message,
                    timestamp: new Date().toISOString()
                });
                
                // Scroll to bottom
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1500);
        }

        // Display user message
        function displayUserMessage(message) {
            const messageElement = document.createElement('div');
            messageElement.className = 'p-3 user-message w-max max-w-xs ml-auto';
            messageElement.textContent = message;
            chatContainer.appendChild(messageElement);
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'user',
                message: message,
                timestamp: new Date().toISOString()
            });
            
            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Display options
        function displayOptions(options) {
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button w-full text-left px-4 py-2 bg-white border border-gray-200 rounded-full hover:bg-blue-50 hover:border-blue-200';
                button.textContent = option.text;
                //show user's selection before processing to next state
                button.onclick = () => {
                    displayUserMessage(option.text);
                    selectOption(option.next);
                };
                optionsContainer.appendChild(button);
            });
        }

        // Select option
        function selectOption(nextState) {
            currentState = nextState;
            const state = chatbotKnowledge[currentState];
            
            // If input is expected, don't display options yet
            if (state.inputExpected) {
                displayBotMessage(state.message);
                if (state.options) {
                    displayOptions(state.options);
                } else {
                    optionsContainer.innerHTML = '';
                }
            } else {
                displayBotMessage(state.message);
                if (state.options) {
                    displayOptions(state.options);
                } else {
                    optionsContainer.innerHTML = '';
                }
            }
        }

        // Handle user input
        function handleUserInput() {
            const message = userInput.value.trim();
            if (message === '') return;
            
            displayUserMessage(message);
            userInput.value = '';
            
            const state = chatbotKnowledge[currentState];
            
            // Analyze user input for simple patterns
            if (message.toLowerCase().includes('order') && message.toLowerCase().includes('status')) {
                selectOption('orderStatus');
            } else if (message.toLowerCase().includes('return') || message.toLowerCase().includes('refund')) {
                selectOption('returns');
            } else if (message.toLowerCase().includes('product') || message.toLowerCase().includes('item')) {
                selectOption('productQuestions');
            } else if (message.toLowerCase().includes('account') || message.toLowerCase().includes('login')) {
                selectOption('accountHelp');
            } else if (state.inputExpected) {
                // For states expecting input, analyze the input
                if (currentState === 'orderStatus' || currentState === 'noOrderNumber' || 
                    currentState === 'startReturn' || currentState === 'refundStatus') {
                    // Simulate order lookup
                    if (message.toLowerCase().includes('don\'t') || message.toLowerCase().includes('no')) {
                        displayBotMessage("I couldn't find your order. Please double-check your order number or contact customer support for help.");
                    } else {
                        displayBotMessage(`I found your order #${Math.floor(Math.random() * 1000000)}.`);
                    }
                    displayOptions(state.options);
                } else if (currentState === 'checkAvailability') {
                    displayBotMessage(`The product "${message}" is currently in stock and available for delivery within 2 days.`);
                    displayOptions(state.options);
                } else if (currentState === 'productFeatures') {
                    displayBotMessage(`Here are the key features of ${message}: [Feature 1], [Feature 2], [Feature 3]. Would you like more details about any specific feature?`);
                    displayOptions(state.options);
                } else {
                    // Default fallback for unexpected input
                    selectOption('fallback');
                }
            } else {
                // If no specific pattern matched and no input expected, go to fallback
                selectOption('fallback');
            }
        }

        // Event listeners
        sendButton.addEventListener('click', handleUserInput);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleUserInput();
            }
        });

        // Initialize
        initChatbot();
    </script>
</body>
</html>

